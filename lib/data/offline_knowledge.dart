class OfflineKnowledgeBase {
  static final Map<String, String> knowledge = {
    // ============================
    // CPU — Central Processing Unit
    // ============================
    "apa itu cpu": "CPU adalah otak komputer yang memproses instruksi dan menjalankan operasi logika & aritmatika.",
    "pengertian cpu": "CPU adalah komponen utama komputer yang mengeksekusi instruksi dari program.",
    "fungsi cpu": "Fungsi CPU meliputi: mengolah data, menjalankan instruksi, koordinasi komponen lain.",
    "bagian cpu": "Bagian CPU terdiri dari ALU, CU, dan register.",
    "alu cpu": "ALU adalah bagian CPU yang melakukan operasi matematika dan logika.",
    "cu cpu": "Control Unit mengatur alur data dan mengendalikan kerja CPU.",
    "register cpu": "Register adalah memori kecil super cepat di dalam CPU.",
    "core cpu": "Core adalah unit pemrosesan. Semakin banyak core, semakin banyak tugas yang bisa dikerjakan.",
    "clock speed cpu": "Clock speed adalah kecepatan kerja CPU dalam GHz.",
    "thread cpu": "Thread adalah jalur eksekusi yang diproses oleh CPU.",
    "jenis cpu intel": "Jenis CPU Intel antara lain: i3, i5, i7, i9, Xeon.",
    "jenis cpu amd": "Jenis CPU AMD antara lain: Ryzen 3, Ryzen 5, Ryzen 7, Ryzen 9, Threadripper.",


    // ============================
    // RAM — Random Access Memory
    // ============================
    "apa itu ram": "RAM adalah memori sementara yang digunakan untuk menyimpan data sementara aplikasi berjalan.",
    "pengertian ram": "RAM adalah komponen komputer untuk menyimpan data sementara agar proses lebih cepat.",
    "fungsi ram": "RAM menyimpan data sementara, membantu multitasking, dan mempercepat pemrosesan.",
    "jenis ram": "Jenis RAM: DDR3, DDR4, DDR5.",
    "perbedaan ddr3 ddr4 ddr5": "DDR3 lambat, DDR4 lebih cepat, DDR5 paling cepat dan efisien.",
    "sodimm adalah": "SODIMM adalah RAM ukuran kecil untuk laptop.",
    "long dimm adalah": "Long DIMM adalah RAM panjang untuk PC desktop.",
    "apa itu latency ram": "Latency adalah waktu respon RAM saat mengakses data.",
    "kecepatan ram": "Kecepatan RAM diukur dalam MHz, misalnya 2666, 3200, 4000 MHz.",
    "apa itu dual channel": "Dual channel meningkatkan bandwidth RAM sehingga performa lebih baik.",
    "ciri ram rusak": "RAM rusak biasanya menyebabkan bluescreen, aplikasi crash, dan komputer restart sendiri.",


    // ============================
    // STORAGE — HDD, SSD, NVMe
    // ============================
    "apa itu storage": "Storage adalah tempat penyimpanan data permanen seperti HDD, SSD, dan NVMe.",
    "fungsi storage": "Storage menyimpan OS, aplikasi, file, dan data pengguna.",
    "apa itu hdd": "HDD adalah penyimpanan berbasis piringan dengan kapasitas besar namun lebih lambat.",
    "apa itu ssd": "SSD adalah penyimpanan cepat tanpa komponen bergerak.",
    "apa itu nvme": "NVMe adalah SSD super cepat melalui slot PCIe.",
    "perbedaan hdd dan ssd": "HDD lambat dan murah; SSD cepat dan mahal.",
    "m2 sata adalah": "M.2 SATA adalah SSD yang memakai protokol SATA, kecepatannya sama seperti SSD SATA 2.5.",
    "m2 nvme adalah": "M.2 NVMe adalah SSD sangat cepat memakai protokol PCIe.",
    "ciri ssd rusak": "SSD rusak: boot lambat, file corrupt, sering not responding.",
    "apa itu kapasitas storage": "Kapasitas storage diukur dalam GB atau TB.",
    "jenis storage backup": "Storage backup: HDD eksternal, Flashdisk, NAS.",


    // ============================
    // GPU — Graphics Processing Unit
    // ============================
    "apa itu gpu": "GPU adalah komponen untuk memproses grafis dan visual.",
    "fungsi gpu": "GPU mengolah gambar, video, animasi, rendering 3D, dan game.",
    "gpu integrated": "Integrated GPU menempel di CPU, seperti Intel UHD / AMD Radeon iGPU.",
    "gpu dedicated": "Dedicated GPU adalah kartu grafis terpisah dengan performa tinggi.",
    "fungsi vram": "VRAM menyimpan texture, frame buffer, dan data grafis.",
    "perbedaan gpu nvidia dan amd": "Nvidia unggul AI & raytracing; AMD unggul harga-performa.",
    "apa itu cuda": "CUDA adalah teknologi komputasi paralel Nvidia.",
    "apa itu ray tracing": "Ray Tracing adalah teknik pencahayaan realistis di GPU.",
    "ciri gpu rusak": "GPU rusak: artifact, layar glitch, driver crash, tidak tampil.",


    // ============================
    // MOTHERBOARD
    // ============================
    "apa itu motherboard": "Motherboard adalah papan utama yang menghubungkan semua komponen PC.",
    "fungsi motherboard": "Motherboard mengatur komunikasi antar komponen seperti CPU, RAM, GPU.",
    "chipset adalah": "Chipset menentukan fitur motherboard seperti overclocking dan jumlah port.",
    "socket cpu": "Socket CPU adalah tempat memasang prosesor (AM4, AM5, LGA1200, LGA1700).",
    "form factor motherboard": "Form factor: ATX, Micro ATX, Mini ITX.",


    // ============================
    // PSU — Power Supply Unit
    // ============================
    "apa itu psu": "PSU adalah komponen yang mengubah arus listrik AC menjadi DC untuk komputer.",
    "fungsi psu": "PSU menyuplai daya ke semua komponen PC.",
    "apa itu 80 plus": "Sertifikasi 80+ menunjukkan efisiensi PSU.",
    "psu modular": "Modular PSU memiliki kabel yang bisa dilepas.",
    "psu non modular": "Non-modular PSU memiliki kabel permanen.",


    // ============================
    // INPUT & OUTPUT DEVICE
    // ============================
    "apa itu perangkat input": "Perangkat input adalah alat untuk memasukkan data ke komputer.",
    "contoh perangkat input": "Contoh input: keyboard, mouse, microfon, scanner.",
    "apa itu perangkat output": "Perangkat output adalah alat untuk menampilkan hasil dari komputer.",
    "contoh perangkat output": "Contoh output: monitor, printer, speaker.",


    // ============================
    // NETWORKING (tambahan)
    // ============================
    "apa itu lan": "LAN adalah jaringan lokal dalam area terbatas.",
    "apa itu wifi": "WiFi adalah teknologi jaringan nirkabel.",
    "fungsi router": "Router menghubungkan perangkat ke internet.",
    "apa itu ip address": "IP Address adalah identitas unik perangkat di jaringan.",


    // ============================
    // PERAKITAN PC
    // ============================
    "cara merakit pc": "Merakit PC meliputi pemasangan CPU, RAM, Storage, GPU, PSU, dan kabel manajemen.",
    "thermal paste adalah": "Thermal paste membantu transfer panas antara CPU dan heatsink.",
    "casing airflow": "Airflow casing mempengaruhi suhu CPU & GPU.",
    "apa itu bottleneck": "Bottleneck adalah kondisi ketika satu komponen menghambat performa komponen lain.",
  };


  // =============== MATCH LOGIC (Anti Salah Offline)
  static String? findBestAnswer(String question) {
    final q = question.toLowerCase().trim();

    // 1. Jangan jawab offline jika pertanyaan terlalu pendek
    if (q.length < 6) return null;

    // 2. Keyword wajib (tidak menyalahi topik)
    final allowedKeywords = [
      "cpu","ram","gpu","psu",
      "motherboard","storage",
      "komputer","pc","vga",
      "hdd","ssd","nvme",
      "lan","wifi","router"
    ];

    if (!allowedKeywords.any((k) => q.contains(k))) {
      return null;
    }

    // 3. Cari kecocokan
    double bestScore = 0.0;
    String? bestAnswer;

    knowledge.forEach((key, value) {
      double score = _similarity(q, key);
      if (score > bestScore) {
        bestScore = score;
        bestAnswer = value;
      }
    });

    // 4. Ambang minimal kecocokan
    if (bestScore < 0.35) return null;

    return bestAnswer;
  }

  static double _similarity(String a, String b) {
    final wordsA = a.split(" ");
    final wordsB = b.split(" ");

    int match = 0;
    for (final w in wordsA) {
      if (wordsB.contains(w)) match++;
    }

    return match / wordsB.length;
  }
}
